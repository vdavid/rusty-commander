# SMB server with Unicode share names
# Useful for testing encoding handling, display, and mounting
FROM alpine:3.21

RUN apk add --no-cache samba samba-client

# Create share directories with Unicode names
RUN mkdir -p "/shares/æ—¥æœ¬èªž" && \
    echo "Japanese content" > "/shares/æ—¥æœ¬èªž/æ—¥æœ¬èªž.txt" && \
    mkdir -p "/shares/Ã©mojisðŸ“" && \
    echo "Emoji content" > "/shares/Ã©mojisðŸ“/ðŸŽ‰.txt" && \
    mkdir -p "/shares/Ã‘oÃ±o" && \
    echo "Spanish content" > "/shares/Ã‘oÃ±o/espaÃ±ol.txt" && \
    mkdir -p "/shares/ä¸­æ–‡" && \
    echo "Chinese content" > "/shares/ä¸­æ–‡/ä¸­æ–‡.txt" && \
    mkdir -p "/shares/Î•Î»Î»Î·Î½Î¹ÎºÎ¬" && \
    echo "Greek content" > "/shares/Î•Î»Î»Î·Î½Î¹ÎºÎ¬/ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬.txt"

COPY smb.conf /etc/samba/smb.conf

EXPOSE 445

CMD ["smbd", "--foreground", "--no-process-group", "--debug-stdout"]
